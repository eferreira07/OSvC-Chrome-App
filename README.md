# OSvC Troubleshoot Add-In

<p align="center"><img src ="https://github.com/eferreira07/OSvC-Troubleshoot-Add-In/blob/master/ts_img.jpg"/></p>

This "OSvC Troubleshoot Add-In" was created in order to help customers and partners solve their client/server communication problems through the identification of a diagnosis of the "problem". Once this add-in is compiled and added to your Agent Desktop, it will create a status bar extension (at the very bottom of your Agent Desktop) showing these three objects:

  1. Start Button: Start capturing the problem step to be reproduced by your OSvC Admin.
  2. Stop Button: Stop capture and compile the results to send the problem steps that were reproduced by your OSvC Admin.
  3. Timer: Shows how much time has elapsed when you are capturing your steps.

OSvC Troubleshoot Add-In is a piece of code that helps customers and partners with insights of "how to integrate OSvC and 3rd party tools for troubleshoot". 

**Before downloading and using it, make sure you are licensed under each 3rd party provider as required.**

~~~~
  3rd party tools integrated in this code:
    - Windows PSR: https://support.microsoft.com/en-us/help/22878/windows-10-record-steps
    - FiddlerCore4: http://www.telerik.com/fiddler/fiddlercore
    - OSCinfo.bat: https://cx.rightnow.com/app/answers/detail/a_id/2412
  The source code is using C#.
  Target Framework is .NET Framework 4.5
~~~~

With this piece of code, your agent won't be required to install Fiddler or additional tools on their workstation for troubleshooting.

# How it works
It is intended to be really simple. Let's use this use case in order to understand how it works.

An agent is encountering an issue to use a certain workspace and (s)he has reported that every time a given workspace is opened, a loading error message is showing up.

You as OSvC Admins require more information such as steps to reproduce, data traffic and workstation information. With that you will be able to proceed with a better diagnosis of the "problem" and provide a resolution.

Now, think as an Agent and imagine how hard it is to work with tons of different tools in order to capture what you as Admin needs.

How about asking your Agents to reproduce the issue by pushing a start and stop (located in the Agent Desktop status bar) to capture all you need. See how this idea can improve the communication between your agents and you.

<p align="center"><img src ="https://github.com/eferreira07/OSvC-Troubleshoot-Add-In/blob/master/ts_status_bar.png"/></p>

## Be prepared:
> By default "Decrypt HTTPS traffic" is checked in the code, so Fiddler itself asks to trust the root certificate it generates FiddlerCore. If you select Yes, then software running in the current user account should trust certificates generated by Fiddler. According to Fiddler as published in this [link](http://www.telerik.com/blogs/faq---certificates-in-fiddler).

:point_right: Watch this [demo](https://vimeo.com/224991951) to see how it works.

# Prerequisites
  - OSvC Agent Desktop Installed.
  - OSvC System Requirements as specified [here](https://cx.rightnow.com/app/answers/detail/a_id/31).
  - FiddlerCore Installed **(It should be installed only on the workstation responsible to generate the add-in .zip file, which will be uploaded into OSvC.)** and Licensed as specified [here](http://www.telerik.com/fiddler/fiddlercore).
  - Install FiddlerCore in one of the OSvC Admin or developer desktops who will create the Add-In zip file. OSvC Troubleshoot Add-In uses FiddlerCore4 dlls.
  - Download pre-built OSvC Troubleshoot Add-In or download the source code and compile by yourself.

# Features
With OSvC Troubleshoot Add-In, your agents will be able to:
  - Capture screenshots and steps to reproduce.
  - Capture Data Traffic (HTTP Request and Response).
  - Capture workstation specifications in order to make sure it does or does not meet the minimum requirements.
  - Show how long the screen capture is running
  - Timely reminder. In case an Agent leaves the process capturing, we ask whether (s)he wants to stop or continue capturing.
  - Zip information to be diagnosed by an OSvC Admin such as Fiddler (.SAZ), Steps to reproduce (.mhtm) and Workstation Information (.html / .txt).
  - Pre-write an email and attach the information to be diagnosed by an OSvC Admin for diagnosis. If your agent is granted to the "attach" privileges it will automatically attach, otherwise you can use the word "attach" in the e-mail body and Outlook will remind the user to attach the file.
  - Personalize your messages to the agent. Two messages are expected, once agent starts and stops the capture.
  - Personalize where you want to save the zip file with the information to be diagnosed.
  - Assign OSvC Troubleshoot to one staff account or many.
  - Server Configuration Property. Setting your preferences per profile.
  
# Installation
Creating the OSvC Troubleshoot Add-In zip file.
  1.	Download FiddlerCore, accept the license agreement and install.
  2.	Once FiddlerCore has been installed successfully, the following path will be automatically created %userprofile%\desktop\FiddlerCoreAPI
  3.	Download the pre-built add-in as "Troubleshoot_StatusBar.zip" (do not change this name). Download the zip file in the same directory created by FiddlerCore, it will make things easier.
  4.	Drag the following three dlls and drop into the existing "Troubleshoot_StatusBar.zip".
        - FiddlerCore4.dll
        - CertMaker.dll
        - BCMakeCert.dll

:point_right: If the above steps didn't work for you, I would recommend to unzip and rezip all the required dll.

As a result of the above steps your Troubleshoot_StatusBar.zip should contain the following 6 .dll files: 
  1. FiddlerCore4.dll
  2. CertMaker.dll
  3. BCMakeCert.dll
  4. Ionic.Zip.Reduced.dll
  5. System.IO.Compression.FileSystem.dll
  6. Troubleshoot_StatusBar.dll.

:point_right: Watch this [demo](https://vimeo.com/224978749).

# Associate "OSvC Troubleshoot Add-In" to an existing profile
For instructions on uploading an add-in and allowing access to an individual add-in for each profile and interface, access the [OSvC Documentation here](http://docs.oracle.com/cloud/latest/servicecs_gs/FAMUG/_core.htm#FAMUGbr1130149).

Once "OSvC Troubleshoot Add-In" has been uploaded, the following Server Configuration Property will be available per profile:
- AgentPermission: Staff Account Login. Use “;” without space to determine who will have access to the OSvC Troubleshoot Add-In. If it is null, no one is going to see the Add-In.
- DataTraffic: By default it is “Y”. Set to “N” if you don’t want to use fiddler to capture data traffic.
- ScreenCapture: By default it is “Y”. Set to “N” if you don’t want to use Windows PSR to capture the user’s steps and screenshots.
- WorkstationInfo: By default it is “Y” to run OSCInfo.bat (More information about the bat file is available in [Answer 2412](https://cx.rightnow.com/app/answers/detail/a_id/2412/). OSCInfo.bat will capture the detailed workstation’s information, but if you don’t want to run the data collector set it to “N”. When this property is defined as ”N”, basic information such as Processor, .NET Version, memory and processor will be captured.
- Timer: As default it is 5 (min). The timer will be used to reminder the agent every (x min) if (s)he has not stopped the capture process. A message will pop up asking if (s)he wants to continue or not.
- TSPath: By default OSvC Troubleshoot Add-In will create a folder in the agent’s desktop to save capture results. The results will be stored in folders using Agent Login > “date and time”; however, if you prefer to define your own directory, even if it is a server folder, go ahead and fill this property.
- If you want to make agent’s life easier, help themby creating a default e-mail subject, body and defining who has to receive the information captured. *use the word “attach” in the body, so if the agent doesn’tattach the files, Outlook is going to remind them.
  - EmailSubject: Define the email’s subject.
  - EmailBody: Define the email body with a friendly message.
  - OSvCAdmin: fill with your e-mail address or who needs to be informed with the results created by the troubleshoot add-in. Multiples e-mail should use “;”.
 - InitialNotification: Personalize the initial message that the agent is going to receive before starting the capturing process.
 - FinalNotification: Personalize the final message that the agent is going to receive once the capture has been finished.

# To be prepared
1. According to Fiddler "By default "Decrypt HTTPS traffic" is checked in the code, so Fiddler itself asks to trust the root certificate it generates FiddlerCore. If you select Yes, then software running in the current user account should trust certificates generated by Fiddler." For more information [click here](http://www.telerik.com/blogs/faq---certificates-in-fiddler).

2. Applying OSvC Troubleshoot Add-In to the upgrade site: If you are adding to the upgrade site, be prepared to receive a warning message. For more information [click here](https://cx.rightnow.com/app/answers/detail/a_id/1925/kw/add-in%20upgrade%20site).

# How to use the information provided by this add-in
The add-in will compile three information, but two of them is the key information to start analysis.
1. Step_to_Reproduce.zip 
2. fiddler_mmddyyyyhhmmss. saz

Note that Step_to_Reproduce.zip gives to you the steps, screenshots and very important, the time (hh: mm: SS) that step has happened.  With that, you'll able to cross the information between "fiddler_mmddyyyyhhmmss. saz" and "Steps_to_Reproduce.zip".

Crossing information, you'll able to understand what happens to the request and response. Also, through the request and response XML (using fiddler client), you'll to determine whether the error is caused by custom rule, customizations or product.

It is just an insight, information, but use the information provided by this add-in as you need to troubleshoot and determine the potential cause.
